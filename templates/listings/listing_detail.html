{% extends 'base.html' %}
{% load static %}

{% block title %}{{ listing.title }} | KeystoneBid{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pages/listing.css' %}">
{% endblock %}

{% block content %}
<article class="listing-detail">
    <section class="card">
        <h1 style="margin-bottom: 0.75rem;">{{ listing.title }}</h1>
        {% if listing.featured_image %}
            <img src="{{ listing.featured_image.url }}" alt="{{ listing.title }}" style="border-radius: 8px; margin-bottom: 1rem;">
        {% endif %}
        <p style="margin-bottom: 1rem;">{{ listing.description }}</p>

        {% if listing.additional_images.all %}
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem;">
                {% for image in listing.additional_images.all %}
                    <img src="{{ image.image.url }}" alt="Additional image {{ forloop.counter }}" style="border-radius: 6px;">
                {% endfor %}
            </div>
        {% endif %}
    </section>

    <aside class="card">
        <h2 style="font-size: 1.2rem; margin-bottom: 0.75rem;">Auction details</h2>
        <p><strong>Current price:</strong> ${{ listing.current_price }}</p>
        <p><strong>Starting price:</strong> ${{ listing.starting_price }}</p>
        <p><strong>County:</strong> {{ listing.county }}</p>
        <p><strong>Year:</strong> {{ listing.license_year }}</p>
        <p><strong>Type:</strong> {{ listing.license_type }}</p>
        <p><strong>Condition:</strong> {{ listing.get_condition_grade_display }}</p>
        <p><strong>Auction ends:</strong> {{ listing.auction_end|date:"M j, Y, g:i a" }}</p>
        <p><strong>Status:</strong> {{ listing.get_status_display }}</p>

        {% if user.is_authenticated and listing.seller_id == user.id %}
            <div style="margin-top: 1rem;">
                <a class="btn-secondary" href="{% url 'listings:edit' listing.pk %}">Edit listing</a>
            </div>
        {% endif %}
    </aside>
</article>
{% endblock %}
